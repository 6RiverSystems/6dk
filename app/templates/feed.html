{% extends "base.html" %}

{% block app_content %}
<div class="center-align">
	<div class="chip center-align">{{ messages|length }}</div> messages found across
	<div class="chip center-align">all profiles</div> between
	<div class="chip center-align">the start of time</div> and
	<div class="chip center-align">the end of time</div>
	<a class="btn-floating blue darken-4 waves-effect modal-trigger tooltipped" data-position="bottom" data-tooltip="Search Messages" href="#filterModal" >
	    <i class="material-icons">search</i>
	</a>
	<a class="btn-floating blue darken-4 waves-effect modal-trigger tooltipped" data-position="bottom" data-tooltip="Clear Filters" href="#" >
	    <i class="material-icons">clear</i>
	</a>
</div>
</br>
<div class="divider"></div>
</br>
{% for message in messages %}
<pre>
	<code class="prettyprint">
		{{ message.unmasked_data }}
	</code>
</pre>
<div class="card-panel hoverable">
	<div class="row">
		<div class="col s6">
			<div class="chip center-align">
				{{ message.message_type }}
			</div>
		</div>
		<div class="col s6 right-align">
			<small class="tooltipped" data-position="top" data-tooltip="{{ message.updated.isoformat() }}Z">{{ moment( message.updated ).format('lll') }}</small><small class="tooltipped" data-position="top" data-tooltip="{{ message.token_id }}"> via {{ message.profile.data.friendly_name }}</small>
		</div>
	</div>
	<div class="divider"></div>
	<div class="right-align">
        {% if message.message_type in valid_northbound %}
        <a class="waves-effect waves-blue btn-flat tooltipped" data-position="top" data-tooltip="Replay Message" href="#">
            <i class="material-icons">replay</i>
        </a>
        {% endif %}
        <a class="waves-effect waves-blue btn-flat tooltipped" data-position="top" data-tooltip="View Data" href="#">
            <i class="material-icons">code</i>
        </a>
    </div>
</div>
{% endfor %}

<div id="filterModal" class="modal top-sheet">
  <div class="modal-content">
    <h5 class="center-align">Search Message Feed</h5>
  <div class="row">
    <form class="col s12" id="filterForm" name="filterForm" action="#" method="get">
      <div class="row">

      </div>

      <div class="row">
        <div class="input-field col s12">
          <p class="center-align">
            <button class="waves-effect waves-light btn-floating blue darken-4 z-depth-3" type="submit" name="action">
              <i class="material-icons right">search</i>
            </button>
          </p>
        </div>
      </div>

    </form>
  </div>
  </div>
  <div class="modal-footer">
    <a href="#!" class="modal-close waves-effect waves-blue btn-flat">Dismiss</a>
  </div>
</div>

{{ moment.include_jquery() }}
{{ moment.include_moment() }}
{% endblock %}